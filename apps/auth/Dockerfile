FROM svhd/logto:latest

ARG RAILWAY_ENVIRONMENT
ARG PORT
ARG DATABASE_URL
ARG ADMIN_ENDPOINT
ARG ENDPOINT

ENV RAILWAY_ENVIRONMENT=$RAILWAY_ENVIRONMENT
ENV PORT=$PORT
ENV DB_URL=$DATABASE_URL
ENV ADMIN_ENDPOINT=$ADMIN_ENDPOINT
ENV ENDPOINT=$ENDPOINT

ENTRYPOINT ["sh", "-c", "npm run cli db seed -- --swe && npm start"]